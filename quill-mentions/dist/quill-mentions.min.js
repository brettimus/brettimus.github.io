!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b,c){this.format=a,this.view=b,this.data=c.data,this.max=c.max}function e(a,b,c){this.path=c.path,this.queryParameter=c.queryParameter,this._latestCall=null}function f(a){console.log("Loading json errored! Likely due to aborted request, but there's the error: ",a)}var g=a("./utilities/ajax").loadJSON,h=a("./utilities/regexp").escapeRegExp;b.exports={Controller:d,AJAXController:e},d.prototype.search=function(a,b){var c=this.data.filter(function(b){var c=new RegExp(h(a),"i");return c.test(b.name)});this.view.render(c.slice(0,this.max)),b&&b()},e.prototype=Object.create(d.prototype),e.prototype.search=function(a,b){this._latestCall&&this.latest.abort();var c=this.path+"?"+this.queryParameter+"="+encodeURIComponent(a);this._latestCall=g(c,this._callback.bind(this),f)},e.prototype._callback=function(a){a=a.slice(0,this.max),this.view.render(a.map(this.formatter))}},{"./utilities/ajax":6,"./utilities/regexp":10}],2:[function(a,b,c){function d(a){var b=e({},g,a);return a.ajax&&(b.ajax=e({},h,a.ajax)),b}var e=a("../utilities/extend"),f=a("../utilities/identity"),g={ajax:!1,choiceMax:6,choices:[],choiceTemplate:'<li data-display="{{choice}}" data-mention="{{data}}">{{choice}}</li>',containerClassName:"ql-mentions",format:f,includeTrigger:!1,matcher:/@\w+$/i,mentionClass:"mention-item",noMatchMessage:"Ruh Roh Raggy!",noMatchTemplate:"<li class='ql-mention-choice-no-match'><i>{{message}}</i></li>",paddingTop:10,template:"<ul>{{choices}}</ul>",triggerSymbol:"@"},h={format:f,path:null,queryParameter:"q"};b.exports=d},{"../utilities/extend":8,"../utilities/identity":9}],3:[function(a,b,c){(function(b){b.QuillMentions=a("./mentions")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./mentions":5}],4:[function(a,b,c){function d(){h.call(this,1)}function e(){h.call(this,-1)}function f(){var a,b,c=this.selectedChoiceIndex;console.log("handling enter"),-1!==c&&(a=this.view.container.querySelectorAll("li"),0!==a.length&&(b=a[c],this.addMention(b),this.selectedChoiceIndex=-1))}function g(){this.view.hide(),this.isMentioning=!1,this.quill.focus()}function h(a){var b,c,d,e,f=this.selectedChoiceIndex;return b=this.view.container.querySelectorAll("li"),0===b.length?void(this.selectedChoiceIndex=-1):(-1!==f&&(c=b[f],l(c,m)),d=i(f+a,b.length),e=b[d],void(e?(k(e,m),this.selectedChoiceIndex=d):console.log("Indexing error on node returned by querySelectorAll")))}function i(a,b){if(0>=b)throw new Error("WTF are you doing? _normalizeIndex needs a nonnegative, nonzero modulo.");for(;0>a;)a+=b;return a%b}var j=a("./utilities/dom"),k=j.addClass,l=j.removeClass,m="ql-mention-choice-selected",n={13:f,27:g,38:e,40:d};b.exports=n},{"./utilities/dom":7}],5:[function(a,b,c){function d(a,b){this.quill=a;var c=j(b),d=this.quill.addContainer(c.containerClassName);this.triggerSymbol=c.triggerSymbol,this.includeTrigger=c.includeTrigger,this.matcher=c.matcher,this.mentionClass=c.mentionClass,this.isMentioning=!1,this.currentMention=null,this.selectedChoiceIndex=-1,this.setView(d,c).setController(c).listenTextChange(a).listenSelectionChange(a).listenHotKeys(a).listenClick(d).addFormat(),this._cachedRange=null}var f=a("./controller").AJAXController,g=a("./controller").Controller,h=a("./view"),i=a("./utilities/extend"),j=a("./defaults/defaults"),k=a("./keyboard");b.exports=d,d.prototype.setView=function(a,b){var c={};return c.list=b.template,c.listItem=b.choiceTemplate,c.error=b.noMatchTemplate,this.view=new h(a,c),this},d.prototype.setController=function(a){if(!this.view)throw new Error("Must set view before controller.");var b,c={max:a.choiceMax};return a.ajax?(b=a.ajax.format,i(c,a.ajax),this.controller=new f(b,this.view,c)):(b=a.format,c.data=a.choices,this.controller=new g(b,this.view,c)),this},d.prototype.listenTextChange=function(a){function b(b){var c,d,e=this.findMention();e?(d=this,this._cachedRange=a.getSelection(),this.isMentioning=!0,this.currentMention=e,c=e[0].replace(this.triggerSymbol,""),this.controller.search(c,function(){d.view.show(d.quill)})):(this.isMentioning=!1,this.view.hide())}var c=this.quill.constructor.events.TEXT_CHANGE;return a.on(c,b.bind(this)),this},d.prototype.listenSelectionChange=function(a){function b(b){b||(this.view.hide(),a.setSelection(null))}var c=a.constructor.events.SELECTION_CHANGE;return a.on(c,b.bind(this)),this},d.prototype.listenHotKeys=function(a){function b(a){var b=a.keyCode||a.which;(this.isMentioning||13===b)&&(c.call(this,b),a.stopPropagation(),a.preventDefault())}function c(b){var c=k[b];c&&(a.setSelection(this._cachedRange),c.call(this))}return a.container.addEventListener("keyup",b.bind(this),!1),this},d.prototype.listenClick=function(a){function b(a){var b=a.target||a.srcElement;"li"===b.tagName.toLowerCase()&&(console.log(b),this.addMention(b)),e.stopPropagation()}return a.addEventListener("click",b.bind(this)),a.addEventListener("touchend",b.bind(this)),this},d.prototype.findMention=function(){var a=this.quill.getSelection().end,b=this.quill.getText(0,a);return this.matcher.exec(b)},d.prototype.addMention=function(a){var b=this.currentMention.index,c=(this.includeTrigger?this.triggerSymbol:"")+a.dataset.display,d=b+c.length+1;this.quill.deleteText(b,b+this.currentMention[0].length),this.quill.insertText(b,c,"mention",this.mentionClass+"-"+a.dataset.mention),this.quill.insertText(b+c.length," "),this.quill.setSelection(d,d),this.isMentioning=!1,this.view.hide()},d.prototype.hasSelection=function(){return-1!==this.selectedChoiceIndex},d.prototype.addFormat=function(a){return this.quill.addFormat("mention",{tag:"SPAN","class":"ql-"}),this}},{"./controller":1,"./defaults/defaults":2,"./keyboard":4,"./utilities/extend":8,"./view":12}],6:[function(a,b,c){b.exports={loadJSON:function(a,b,c){var d=new XMLHttpRequest;return d.onreadystatechange=function(){d.readyState===XMLHttpRequest.DONE&&(200===d.status?b&&b(JSON.parse(d.responseText)):c&&c(d))},d.open("GET",a,!0),d.send(),d}}},{}],7:[function(a,b,c){function d(a,b){f(a,b)||(a.className+=" "+b)}function e(a){var b=[a];if(!a)return[];for(;a.previousSibling;)b.push(a.previousSibling),a=a.previousSibling;return b}function f(a,b){return a?-1!==a.className.indexOf(b):void 0}function g(a,b){if(f(a,b))for(;-1!==a.className.indexOf(b);)a.className=a.className.replace(b,"")}b.exports.addClass=d,b.exports.getOlderSiblingsInclusive=e,b.exports.hasClass=d,b.exports.removeClass=g},{}],8:[function(a,b,c){function d(a){for(var b=[].slice.call(arguments,0),c=b[0],d=1;d<b.length;d++)c=e(c,b[d]);return c}function e(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}b.exports=d},{}],9:[function(a,b,c){function d(a){return a}b.exports=d},{}],10:[function(a,b,c){b.exports={escapeRegExp:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}},{}],11:[function(a,b,c){function d(a,b,c,d){d=d||"";var f="g"+d,g=new RegExp(e(b),f);return a.replace(g,c)}var e=a("./regexp").escapeRegExp;b.exports={all:d}},{"./regexp":10}],12:[function(a,b,c){function d(a,b,c){this.container=a,this.templates=f({},b),this.options=c||{}}var e=a("./utilities/dom"),f=a("./utilities/extend"),g=a("./utilities/string-replace").all;b.exports=d,d.prototype.render=function(a){var b,c;return a&&a.length?(b=a.map(this._renderLI,this).join(""),c=this.templates.list.replace("{{choices}}",b),this._renderSucess(c)):(c=this.templates.listItem.replace("{{choices}}",this.error),this._renderError())},d.prototype._renderSucess=function(a){return this.container.innerHTML=a,this},d.prototype._renderError=function(a){return this.container.innerHTML=a,this},d.prototype._renderLI=function(a){var b=this.templates.listItem;return b=g(b,"{{choice}}",a.name),b=g(b,"{{data}}",a.data)},d.prototype.hide=function(a,b){return e.removeClass(this.container,"ql-is-mentioning"),this.container.style.marginTop="0",b&&a.setSelection(b),this},d.prototype.isHidden=function(){return e.hasClass(this.container,"ql-is-mentioning")},d.prototype.show=function(a){return this.container.style.marginTop=this._getNegativeMargin(a),e.addClass(this.container,"ql-is-mentioning"),this.container.focus(),this},d.prototype._findOffsetLines=function(a){var b=this._findMentionNode(a);return e.getOlderSiblingsInclusive(b)},d.prototype._findMentionNode=function(a){var b,c,d,e,f=a.getSelection();for(b=a.editor.doc.findLeafAt(f.start,!0),c=b[0],d=b[1],c&&(e=c.node);e&&"DIV"!==e.tagName;)e=e.parentNode;return e?e:null},d.prototype._getNegativeMargin=function(a){var b,c=a.editor.root,d=this.paddingTop||10,e=-d;return b=this._findOffsetLines(a),e+=this._nodeHeight(c),e-=b.reduce(function(a,b){return a+this._nodeHeight(b)}.bind(this),0),"-"+e+"px"},d.prototype._nodeHeight=function(a){return a.getBoundingClientRect().height}},{"./utilities/dom":7,"./utilities/extend":8,"./utilities/string-replace":11}]},{},[1,2,3,4,5,6,7,8,9,10,11,12]);
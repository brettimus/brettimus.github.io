<html>
<head>
  <meta charset="UTF-8">
  <title>jukebox bruh</title>
</head>
<body>
  
  <script src="./bower_components/d3/d3.js"></script>
  <script src="./bower_components/moment/moment.js"></script>
  <script>
      var timeFormat = "%a %b %e %X %Y",
          parseTime  = d3.time.format(timeFormat).parse;
          
      d3.text("./jukebox-top100.csv", function(text) {
          var data   = d3.csv.parseRows(text);
          var result = munge(data);
          d3.select("body")
            .selectAll("svg")
            .attr({height: 500, width: 960-100})
            .data([result])
            .enter()
            .append("g")
            .attr("transform", "translate("+[60,60]+")")
            // .call(/* */)

          console.log(result);
      });

      function munge(data) {
          return data.map(function(d) {
              var ts = JSON.parse(d[4]).map(parseTime);

              return {
                  album: d[1],
                  artist: d[0],
                  count: parseInt(d[3], 10),
                  timestamps: ts,
                  title: d[2],
              }
          });
      }
  </script>
</body>
</html>